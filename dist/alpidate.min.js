(()=>{function x(r,e,i){let s={$invalid:!1};return e.forEach(n=>{let[c,l]=n.split(":"),t=!1;switch(c){case"required":t=r===null||r===""||r===void 0||Array.isArray(r)&&r.length===0;break;case"requiredIf":let[$,d]=l.split(",");""+i[$]===d&&(t=r===null||r===""||r===void 0);break;case"array":t=!Array.isArray(r);break;case"min":(typeof r=="string"||Array.isArray(r))&&(t=r.length<Number(l));break;case"max":(typeof r=="string"||Array.isArray(r))&&(t=r.length>Number(l));break;case"numeric":t=isNaN(r);break;case"email":t=!/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(r);break;case"regex":try{let p=l?new RegExp(l):null;t=p?!p.test(r):!0}catch{t=!0}break}s[c]=t,t&&(s.$invalid=!0)}),s}function w(r,e){let i={};for(let s in e)if(s.includes("*")){let c=s.split(".")[0];(r[c]||[]).forEach((t,$)=>{let d=s.replace("*",$);i[d]=e[s]})}else i[s]=e[s];return i}function N(r,e,i){let s=w(r,e);for(let n in s)r[i].validate(n),r.$watch(n,()=>r[i].validate(n));return r}function j(r){r.magic("validation",()=>(e,i=null)=>{i||(i="$v"),e[i]={},e[i].$touch=!1,e[i].$invalid=!0;let s=JSON.parse(JSON.stringify(e.validations));e[i].validate=(n=null)=>{let c=w(e,s),l=n?[n]:Object.keys(c);n||(e[i].$touch=!0),l.forEach(t=>{let $=c[t],d=t.split("."),f=e[i],u=e;d.forEach((a,o)=>{if(!isNaN(Number(a))){u=u[a];return}f[a]||(f[a]={$invalid:!1}),f=f[a],u=u[a]??u[a]}),Object.assign(f,x(u,$,e)),Array.isArray(u)&&Object.keys(s).find(o=>o.includes("*")&&o.startsWith(d[0]))&&(f.each=u.map((o,m)=>{let b={};return Object.keys(s).filter(h=>h.startsWith(d[0]+".*")).map(h=>({fieldName:h.split(".").slice(-1)[0],rules:s[h]})).forEach(h=>{b[h.fieldName]=x(o[h.fieldName],h.rules,e)}),b}),f.$invalid=f.each.some(o=>Object.values(o).some(m=>m.$invalid)));let p=t.split(".");if(p.length>1){let a=e[i];for(let o=0;o<p.length-1;o++){let m=p[o];if(!a[m])continue;let b=a[m];b.$invalid=Object.values(b).filter(g=>typeof g=="object"&&g!==null).some(g=>g.$invalid),a=b}}})},e[i].reset=()=>e[i].$touch=!1,e=N(e,s,i),e.$watch(i,()=>{e[i].$invalid=Object.keys(e[i]).some(n=>{if(n.startsWith("$"))return!1;let c=e[i][n];return c.$invalid?!0:c.each?c.each.some(l=>Object.values(l).some(t=>t.$invalid)):!1})}),Object.entries(s).forEach(([n,c])=>{c.forEach(l=>{if(l.startsWith("requiredIf:")){let t=l.split(":")[1].split(",")[0];e.$watch(t,()=>{e[i].validate(n)})}})})})}})();
